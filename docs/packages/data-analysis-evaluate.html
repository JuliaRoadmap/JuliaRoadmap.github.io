<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Roadmap</title>
	<meta name="tURL" id="tURL" content="../../"/>
	<meta name="description" content="包的使用/评估模型 - Roadmap">
	<script src="../../js/menu.js"></script>
	<script src='https://giscus.app/client.js' data-repo='JuliaRoadmap/zh' data-repo-id='R_kgDOHQYI2Q' data-category='General' data-category-id='DIC_kwDOHQYI2c4CO2c9' data-mapping='pathname' data-reactions-enabled='1' data-emit-metadata='0' data-input-position='top' data-theme='preferred_color_scheme' data-lang='zh-CN' crossorigin='anonymous' async></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../js/main.js"></script>
	<link id="theme-href" rel="stylesheet" type="text/css" href="../../css/light.css">
	<link rel="stylesheet" type="text/css" href="../../css/general.css">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
</head>
<body>
	<div id="documenter">
		<nav class="docs-sidebar">
			<a class="docs-logo"><img src="../../assets/images/logo.png" alt="alt" height="96" width="144"></a>
			<div class="docs-package-name">
			<span class="docs-autofit">Roadmap</span>
			</div>
			<ul class="docs-menu"></ul>
		</nav>
		<div class="docs-main">
			<header class="docs-navbar">
				<nav class="breadcrumb">
					<ul class="is-hidden-mobile"><li class="is-active">包的使用 / 评估模型</li></ul>
					<ul class="is-hidden-tablet"><li class="is-active">包的使用 / 评估模型</li></ul>
				</nav>
				<div class="docs-right">
					<a class="docs-edit-link" href="https://github.com/JuliaRoadmap/zh/tree/master/docs/packages/data-analysis-evaluate.md" target="_blank">
						<span class="docs-label is-hidden-touch">编辑此页面</span>
					</a>
					<a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="设置"></a>
					<a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a>
				</div>
			</header>
			<article class="content"><h1 id='header-评估模型'>评估模型<a class='docs-heading-anchor-permalink'></a></h1><p><img src='/assets/images/evaluate/1.png' alt='image'></p><h2 id='header-1. 一个例子'>1. 一个例子<a class='docs-heading-anchor-permalink'></a></h2><p>数据准备</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-type">X&nbsp;</span><span class="hl-plain">=&nbsp;(a&nbsp;=&nbsp;</span><span class="hl-function">rand</span><span class="hl-plain">(</span><span class="hl-number">12</span><span class="hl-plain">),&nbsp;b&nbsp;=&nbsp;</span><span class="hl-function">rand</span><span class="hl-plain">(</span><span class="hl-number">12</span><span class="hl-plain">),&nbsp;c&nbsp;=&nbsp;</span><span class="hl-function">rand</span><span class="hl-plain">(</span><span class="hl-number">12</span><span class="hl-plain">))<br />y&nbsp;=&nbsp;</span><span class="hl-type">X</span><span class="hl-plain">.a&nbsp;.+&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">&nbsp;.*&nbsp;</span><span class="hl-type">X</span><span class="hl-plain">.b&nbsp;+&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">05</span><span class="hl-plain">&nbsp;.*&nbsp;</span><span class="hl-function">rand</span><span class="hl-plain">(</span><span class="hl-number">12</span><span class="hl-plain">)<br /></span></div></div><br /><p>模型训练</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">model&nbsp;=&nbsp;</span><span class="hl-macro">@load</span><span class="hl-plain">&nbsp;</span><span class="hl-type">RidgeRegressor&nbsp;pkg</span><span class="hl-plain">=</span><span class="hl-type">MultivariateStats</span><span class="hl-plain"><br /></span></div></div><br /><p>[评估]单个measure</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">rng&nbsp;=&nbsp;</span><span class="hl-type">StableRNG</span><span class="hl-plain">(</span><span class="hl-number">1234</span><span class="hl-plain">)<br />cv&nbsp;=&nbsp;</span><span class="hl-type">CV</span><span class="hl-plain">(nfolds&nbsp;=&nbsp;</span><span class="hl-number">3</span><span class="hl-plain">,&nbsp;shuffle&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">)&nbsp;</span><span class="hl-comment">#&nbsp;重采样策略</span><br /><span class="hl-function">evaluate</span><span class="hl-plain">(model,&nbsp;</span><span class="hl-type">X,&nbsp;y,&nbsp;resampling&nbsp;</span><span class="hl-plain">=&nbsp;cv,&nbsp;measure&nbsp;=&nbsp;l2)<br /><br /></span><span class="hl-comment">#&nbsp;也可以这样,&nbsp;下面也是</span><br /><span class="hl-plain">mach&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(model,&nbsp;</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">)<br /></span><span class="hl-function">evaluate!</span><span class="hl-plain">(mach,&nbsp;resampling&nbsp;=&nbsp;cv,&nbsp;measure&nbsp;=&nbsp;l2)<br /></span></div></div><br /><table style='float:center'><thead><tr><td>_.measure</td><td>_.measurement</td><td>_.per_fold</td></tr></thead><tbody><tr><td>l2</td><td>0.164</td><td>[0.105, 0.23, 0.158]</td></tr></tbody></table><p>_.per_observation = [[[0.288, 0.128, ..., 0.186], [0.136, 0.534, ..., 0.348], [0.435, 0.0345, ..., 0.298]], missing, missing]</p><p>[评估] 多个measure</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-function">evaluate</span><span class="hl-plain">(model,&nbsp;</span><span class="hl-type">X,&nbsp;y,&nbsp;resampling&nbsp;</span><span class="hl-plain">=&nbsp;cv,&nbsp;measure&nbsp;=&nbsp;[l1,&nbsp;rms,&nbsp;rmslp1])<br /></span></div></div><br /><table style='float:center'><thead><tr><td>_.measure</td><td>_.measurement</td><td>_.per_fold</td></tr></thead><tbody><tr><td>l1</td><td>0.35</td><td>[0.505, 0.319, 0.226]</td></tr><tr><td>rms</td><td>0.424</td><td>[0.51, 0.454, 0.273]</td></tr><tr><td>rmslp1</td><td>0.197</td><td>[0.193, 0.256, 0.116]</td></tr></tbody></table><p>_.per_observation = [[[0.61, 0.514, ..., 0.414], [0.00912, 0.486, ..., 0.0136], [0.139, 0.144, ..., 0.491]], missing, missing]</p><p>来看看文档是怎么解释这些参数的</p><div class='language language-'><div class='codeblock-header'></div><div class='codeblock-body'>•   measure: the vector of specified measures<br /><br />•   measurements: the corresponding measurements, aggregated across the<br />	test folds using the aggregation method defined for each measure<br />	(do aggregation(measure) to inspect)<br /><br />•   per_fold: a vector of vectors of individual test fold evaluations<br />    (one vector per measure)<br /><br />•   per_observation: a vector of vectors of individual observation<br />    evaluations of those measures for which<br />    reports_each_observation(measure) is true, which is otherwise<br />    reported missing.<br /></div></div><br /><p><strong>在这里我们统一用<code>evaluate!(machine)</code>的规定</strong></p><h2 id='header-2. 评估模型的必要参数'>2. 评估模型的必要参数<a class='docs-heading-anchor-permalink'></a></h2><h3 id='header-2.1 resampling'>2.1 resampling<a class='docs-heading-anchor-permalink'></a></h3><p>内置重采样策略有三个， Holdout, CV 与 StratifiedCV</p><h4 id='header-2.1.1 Holdout'>2.1.1 Holdout<a class='docs-heading-anchor-permalink'></a></h4><p>其实就跟<code>sklearn</code>里的<code>train_test_split</code>差不多，将训练集和测试集按一定比例划分</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">holdout&nbsp;=&nbsp;</span><span class="hl-type">Holdout</span><span class="hl-plain">(;&nbsp;fraction_train=</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">7</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	shuffle=</span><span class="hl-special">nothing</span><span class="hl-plain">,<br />					rng=</span><span class="hl-special">nothing</span><span class="hl-plain">)<br /></span></div></div><br /><h4 id='header-2.1.2.CV'>2.1.2.CV<a class='docs-heading-anchor-permalink'></a></h4><p>交叉验证重采样策略</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">cv&nbsp;=&nbsp;</span><span class="hl-type">CV</span><span class="hl-plain">(;&nbsp;nfolds=</span><span class="hl-number">6</span><span class="hl-plain">,&nbsp;&nbsp;shuffle=</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;rng=</span><span class="hl-special">nothing</span><span class="hl-plain">)<br /></span></div></div><br /><h4 id='header-2.1.3 StratifiedCV'>2.1.3 StratifiedCV<a class='docs-heading-anchor-permalink'></a></h4><p>分层交叉验证重采样策略,仅适用于分类问题（OrderedFactor或Multiclass目标）</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">stratified_cv&nbsp;=&nbsp;</span><span class="hl-type">StratifiedCV</span><span class="hl-plain">(;&nbsp;nfolds=</span><span class="hl-number">6</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shuffle=</span><span class="hl-special">false</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng=</span><span class="hl-type">Random</span><span class="hl-plain">.</span><span class="hl-type">GLOBAL_RNG</span><span class="hl-plain">)<br /></span></div></div><br /><h3 id='header-2.2 measure'>2.2 measure<a class='docs-heading-anchor-permalink'></a></h3><h4 id='header-2.2.1 分类指标'>2.2.1 分类指标<a class='docs-heading-anchor-permalink'></a></h4><ol><li>
<p>混淆矩阵
|           | Ground   | Truth         |
|:---------:|:--------:|:--------:|
| Predicted | Positive | Negative |
| True      | TP       | FN       |
| False     | FP       | TN       |</p>
</li>
</ol><ol><li>
<p>由混淆矩阵推导出的概率</p>
<ul>
<li>准确率</li>
<li>精确率</li>
<li>召回率</li>
</ul>
<p>[补充] FScore为精确率与召回率的调和平均</p>
</li>
</ol><p>我太懒了，别人比我总结的好，看这篇文章吧
https://zhuanlan.zhihu.com/p/46714763</p><h4 id='header-2.2.2 回归指标'>2.2.2 回归指标<a class='docs-heading-anchor-permalink'></a></h4><ol><li>l1
<code>∑|(Yᵢ - h(xᵢ)|</code></li>
</ol><ol><li>l2
<code>∑(Yᵢ - h(xᵢ))²</code></li>
</ol><ol><li>mae
平均绝对误差
<code>l1(Ŷ,h(xᵢ)) / n</code></li>
</ol><ol><li>mse
平均平方误差
<code>l2(Ŷ,h(xᵢ)) / n</code></li>
</ol><ol><li>rmse
均方根误差
<code>√(∑(ŷ - y)²</code></li>
</ol><p>ps: 不会用<strong>latex</strong>啊:yum:，函数我都写在w思维导图里了，详细文档<a href='https://alan-turing-institute.github.io/MLJ.jl/stable/performance_measures/' target='_blank'>看这里</a></p><h4 id='header-2.2.3 扩展包 LossFunction'>2.2.3 扩展包 LossFunction<a class='docs-heading-anchor-permalink'></a></h4><p>TODO LossFunctions (外部包)查询
包介绍</p><blockquote><p>The LossFunctions.jl package includes "distance loss" functions for Continuous targets, and "marginal loss" functions for Binary targets. While the LossFunctions,jl interface differs from the present one (for, example Binary observations must be +1 or -1), one can safely pass the loss functions defined there to any MLJ algorithm, which re-interprets it under the hood. Note that the "distance losses" in the package apply to deterministic predictions, while the "marginal losses" apply to probabilistic predictions.</p></blockquote><p>github地址:
https://github.com/JuliaML/LossFunctions.jl</p><p><code>LossFunctions</code>提供了更多的指标，拿文档里的代码举个例子</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-keyword">using</span><span class="hl-plain">&nbsp;</span><span class="hl-type">LossFunctions</span><span class="hl-plain"><br /><br /></span><span class="hl-type">X&nbsp;</span><span class="hl-plain">=&nbsp;(x1=</span><span class="hl-function">rand</span><span class="hl-plain">(</span><span class="hl-number">5</span><span class="hl-plain">),&nbsp;x2=</span><span class="hl-function">rand</span><span class="hl-plain">(</span><span class="hl-number">5</span><span class="hl-plain">));<br />y&nbsp;=&nbsp;</span><span class="hl-function">categorical</span><span class="hl-plain">([</span><span class="hl-string">"y"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"y"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"y"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"n"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"y"</span><span class="hl-plain">]);<br />w&nbsp;=&nbsp;[</span><span class="hl-number">1</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">1</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">3</span><span class="hl-plain">];<br /><br />mach&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(</span><span class="hl-type">ConstantClassifier</span><span class="hl-plain">(),&nbsp;</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">);<br />holdout&nbsp;=&nbsp;</span><span class="hl-type">Holdout</span><span class="hl-plain">(fraction_train=</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">6</span><span class="hl-plain">);<br /></span><span class="hl-function">evaluate!</span><span class="hl-plain">(mach,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure=[</span><span class="hl-type">ZeroOneLoss</span><span class="hl-plain">(),&nbsp;</span><span class="hl-type">L1HingeLoss</span><span class="hl-plain">(),&nbsp;</span><span class="hl-type">L2HingeLoss</span><span class="hl-plain">(),&nbsp;</span><span class="hl-type">SigmoidLoss</span><span class="hl-plain">()],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resampling=holdout,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;operation=predict,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights=w)<br /></span></div></div><br /><table style='float:center'><thead><tr><td>_.measure</td><td>_.measurements</td><td>_.per_fold</td></tr></thead><tbody><tr><td>ZeroOneLoss</td><td>0.4</td><td>[0.4]</td></tr><tr><td>L1HingeLoss</td><td>0.8</td><td>[0.8]</td></tr><tr><td>L2HingeLoss</td><td>1.6</td><td>[1.6]</td></tr><tr><td>SigmoidLoss</td><td>0.848</td><td>[0.848]</td></tr></tbody></table><p>_.per_observation = [[[0.8, 0.0]], [[1.6, 0.0]], [[3.2, 0.0]], [[1.409275324764612, 0.2860870128530822]]]</p><h3 id='header-2.3 weights'>2.3 weights<a class='docs-heading-anchor-permalink'></a></h3><p>权重，无所谓了，必要的时候才设</p><h2 id='header-3. 评估模型的图表'>3. 评估模型的图表<a class='docs-heading-anchor-permalink'></a></h2><h3 id='header-3.1 学习曲线'>3.1 学习曲线<a class='docs-heading-anchor-permalink'></a></h3><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">&nbsp;&nbsp;curve&nbsp;=&nbsp;</span><span class="hl-function">learning_curve</span><span class="hl-plain">(mach;&nbsp;resolution=</span><span class="hl-number">30</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resampling=</span><span class="hl-type">Holdout</span><span class="hl-plain">(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeats=</span><span class="hl-number">1</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure=</span><span class="hl-function">default_measure</span><span class="hl-plain">(machine.model),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rows=</span><span class="hl-special">nothing</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;weights=</span><span class="hl-special">nothing</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;operation=predict,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range=</span><span class="hl-special">nothing</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acceleration=</span><span class="hl-function">default_resource</span><span class="hl-plain">(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acceleration_grid=</span><span class="hl-type">CPU1</span><span class="hl-plain">(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rngs=</span><span class="hl-special">nothing</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rng_name=</span><span class="hl-special">nothing</span><span class="hl-plain">)<br /></span></div></div><br /><p>其实只是名字一样，给定一个范围<code>range</code>(only one)，得到一个曲线<code>curve</code>，这个曲线表示这个范围内的所有性能（指标）
上面那个<code>resolution=30</code>说明<code>learning_curve</code>使用<code>Grid</code>作获取参数的策略</p><p><strong>example</strong> 观察一个模型的性能</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-type">X,&nbsp;y&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-macro">@load_boston</span><span class="hl-plain"><br /><br /></span><span class="hl-macro">@load</span><span class="hl-plain">&nbsp;</span><span class="hl-type">RidgeRegressor&nbsp;pkg</span><span class="hl-plain">=</span><span class="hl-type">MultivariateStats</span><span class="hl-plain"><br />model&nbsp;=&nbsp;</span><span class="hl-type">RidgeRegressor</span><span class="hl-plain">()<br />mach&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(model,&nbsp;</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">)<br /><br />r_lambda&nbsp;=&nbsp;</span><span class="hl-function">range</span><span class="hl-plain">(model,&nbsp;:lambda,&nbsp;lower&nbsp;=&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">01</span><span class="hl-plain">,&nbsp;upper&nbsp;=&nbsp;</span><span class="hl-number">10</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,&nbsp;scale&nbsp;=&nbsp;:linear)<br /></span></div></div><br /><p><strong>默认重采样策略Holdout</strong></p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">curves&nbsp;=&nbsp;</span><span class="hl-function">learning_curve</span><span class="hl-plain">(mach,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range&nbsp;=&nbsp;r_lambda,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;rms)<br /></span><span class="hl-function">plot</span><span class="hl-plain">(curves.parameter_values,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curves.measurements,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;curves.parameter_name,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;</span><span class="hl-string">"Holdout&nbsp;estimate&nbsp;of&nbsp;RMS&nbsp;error"</span><span class="hl-plain">)<br /><br /></span></div></div><br /><p><img src='/assets/images/evaluate/newplot2.png' alt='image'>
<strong>指定重采样策略</strong></p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-keyword">using</span><span class="hl-plain">&nbsp;</span><span class="hl-type">Plots</span><span class="hl-plain"><br />rng&nbsp;=&nbsp;</span><span class="hl-type">StableRNG</span><span class="hl-plain">(</span><span class="hl-number">1234</span><span class="hl-plain">)<br /><br />curves&nbsp;=&nbsp;</span><span class="hl-function">learning_curve</span><span class="hl-plain">(mach,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resampling&nbsp;=&nbsp;</span><span class="hl-type">CV</span><span class="hl-plain">(nfolds&nbsp;=&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">,&nbsp;rng&nbsp;=&nbsp;rng),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range&nbsp;=&nbsp;r_lambda,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;rms)<br /></span><span class="hl-function">plot</span><span class="hl-plain">(curves.parameter_values,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curves.measurements,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;curves.parameter_name,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;</span><span class="hl-string">"Holdout&nbsp;estimate&nbsp;of&nbsp;RMS&nbsp;error"</span><span class="hl-plain">)<br /><br /></span></div></div><br /><p><img src='/assets/images/evaluate/newplot1.png' alt='image'></p><h3 id='header-3.2 ROC'>3.2 ROC<a class='docs-heading-anchor-permalink'></a></h3><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">fprs,&nbsp;tprs,&nbsp;ts&nbsp;=&nbsp;</span><span class="hl-function">roc_curve</span><span class="hl-plain">(ŷ,&nbsp;y)&nbsp;=&nbsp;</span><span class="hl-function">roc</span><span class="hl-plain">(ŷ,&nbsp;y)<br /></span></div></div><br /><p>如果我们的测试数据集类别分布大致均衡的时候我们可以用ROC曲线
给定基本事实y，两类概率预测ŷ，返回ROC曲线。ts返回阈值范围内的真阳性率，假阳性率
其中</p><ol><li>fprs: 假阳性率</li>
</ol><ol><li>tprs: 真阳性率</li>
</ol><ol><li>ts: thresholds 阈值</li>
</ol><p><strong>example</strong>
这里我不给出代码了，因为<code>roc</code>曲线评估的是分类问题，加载数据集，处理那些操作太多了，我就先放图片好了，具体的流程在<strong>Titanic幸存预测里</strong>
<img src='/assets/images/evaluate/newplot3.png' alt='image'></p><h3 id='header-3.3 PR'>3.3 PR<a class='docs-heading-anchor-permalink'></a></h3><p>当数据集类别分布非常不均衡的时候采用PR曲线
但是很遗憾，文档里找不到这个东西</p><h3 id='header-3.3 真正的学习曲线'>3.3 真正的学习曲线<a class='docs-heading-anchor-permalink'></a></h3><p>虽然我找不到这个实现，但是我自己先做了一个</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-keyword">function</span><span class="hl-plain">&nbsp;</span><span class="hl-function">plot_learning_curve</span><span class="hl-plain">(model,&nbsp;</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">)<br />&nbsp;&nbsp;&nbsp;&nbsp;mach&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(model,&nbsp;</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">)<br />&nbsp;&nbsp;&nbsp;&nbsp;training_size_iter&nbsp;=&nbsp;</span><span class="hl-number">5</span><span class="hl-plain">:</span><span class="hl-number">10</span><span class="hl-plain">:</span><span class="hl-function">length</span><span class="hl-plain">(y)<br />&nbsp;&nbsp;&nbsp;&nbsp;errors&nbsp;=&nbsp;</span><span class="hl-function">ones</span><span class="hl-plain">(</span><span class="hl-function">length</span><span class="hl-plain">(training_size_iter),&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">)<br />&nbsp;&nbsp;&nbsp;&nbsp;rng&nbsp;=&nbsp;</span><span class="hl-type">StableRNG</span><span class="hl-plain">(</span><span class="hl-number">1234</span><span class="hl-plain">)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;=&nbsp;</span><span class="hl-number">1</span><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-comment">#&nbsp;for&nbsp;iterate</span><br /><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-keyword">for</span><span class="hl-plain">&nbsp;training_size&nbsp;=&nbsp;training_size_iter<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;train,&nbsp;cv&nbsp;=&nbsp;</span><span class="hl-function">partition</span><span class="hl-plain">(</span><span class="hl-number">1</span><span class="hl-plain">:training_size,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">7</span><span class="hl-plain">,&nbsp;rng&nbsp;=&nbsp;rng)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-function">fit_only!</span><span class="hl-plain">(mach,&nbsp;rows&nbsp;=&nbsp;train)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_train&nbsp;=&nbsp;</span><span class="hl-function">length</span><span class="hl-plain">(train)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-type">Jtrain&nbsp;</span><span class="hl-plain">=&nbsp;(</span><span class="hl-number">1</span><span class="hl-plain">&nbsp;/&nbsp;(</span><span class="hl-number">2</span><span class="hl-plain">&nbsp;*&nbsp;m_train))&nbsp;*&nbsp;</span><span class="hl-function">reduce</span><span class="hl-plain">(+,&nbsp;</span><span class="hl-function">map</span><span class="hl-plain">(x&nbsp;-&gt;&nbsp;x^</span><span class="hl-number">2</span><span class="hl-plain">,&nbsp;</span><span class="hl-function">predict</span><span class="hl-plain">(mach,&nbsp;rows&nbsp;=&nbsp;train)&nbsp;-&nbsp;y[train]))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m_cv&nbsp;=&nbsp;</span><span class="hl-function">length</span><span class="hl-plain">(cv)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-type">Jcv&nbsp;</span><span class="hl-plain">=&nbsp;(</span><span class="hl-number">1</span><span class="hl-plain">&nbsp;/&nbsp;(</span><span class="hl-number">2</span><span class="hl-plain">&nbsp;*&nbsp;m_cv))&nbsp;*&nbsp;</span><span class="hl-function">reduce</span><span class="hl-plain">(+,&nbsp;</span><span class="hl-function">map</span><span class="hl-plain">(x&nbsp;-&gt;&nbsp;x^</span><span class="hl-number">2</span><span class="hl-plain">,&nbsp;</span><span class="hl-function">predict</span><span class="hl-plain">(mach,&nbsp;rows&nbsp;=&nbsp;cv)&nbsp;-&nbsp;y[cv]))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errors[row,&nbsp;:]&nbsp;=&nbsp;[</span><span class="hl-type">Jtrain,&nbsp;Jcv</span><span class="hl-plain">]<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;row&nbsp;+=&nbsp;</span><span class="hl-number">1</span><span class="hl-plain"><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-keyword">end</span><span class="hl-plain"><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-function">plot</span><span class="hl-plain">(errors,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;label&nbsp;=&nbsp;[</span><span class="hl-string">"Jtrain"</span><span class="hl-plain">&nbsp;</span><span class="hl-string">"Jcv"</span><span class="hl-plain">],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color&nbsp;=&nbsp;[:red&nbsp;:blue],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;</span><span class="hl-string">"training&nbsp;size"</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;</span><span class="hl-string">"error"</span><span class="hl-plain">)<br /><br /><br /></span><span class="hl-keyword">end</span><span class="hl-plain"><br /></span></div></div><br /><p>试试看</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-macro">@load</span><span class="hl-plain">&nbsp;</span><span class="hl-type">RidgeRegressor&nbsp;pkg</span><span class="hl-plain">=</span><span class="hl-type">MultivariateStats</span><span class="hl-plain"><br />model&nbsp;=&nbsp;</span><span class="hl-type">RidgeRegressor</span><span class="hl-plain">()<br /></span><span class="hl-type">X,&nbsp;y&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-macro">@load_boston</span><span class="hl-plain"><br /><br /></span><span class="hl-comment">#&nbsp;Tuning</span><br /><span class="hl-plain">rng&nbsp;=&nbsp;</span><span class="hl-type">StableRNG</span><span class="hl-plain">(</span><span class="hl-number">1234</span><span class="hl-plain">)<br />r_lambda&nbsp;=&nbsp;</span><span class="hl-function">range</span><span class="hl-plain">(model,&nbsp;:lambda,&nbsp;lower&nbsp;=&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">1</span><span class="hl-plain">,&nbsp;upper&nbsp;=&nbsp;</span><span class="hl-number">10</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,&nbsp;scale&nbsp;=&nbsp;:linear)<br />tuning&nbsp;=&nbsp;</span><span class="hl-type">Grid</span><span class="hl-plain">(resolution&nbsp;=&nbsp;</span><span class="hl-number">100</span><span class="hl-plain">,&nbsp;rng&nbsp;=&nbsp;rng)<br />resampling&nbsp;=&nbsp;</span><span class="hl-type">CV</span><span class="hl-plain">(nfolds&nbsp;=&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">,&nbsp;rng&nbsp;=&nbsp;rng)<br />self_tuning_model&nbsp;=&nbsp;</span><span class="hl-type">TunedModel</span><span class="hl-plain">(model&nbsp;=&nbsp;model,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range&nbsp;=&nbsp;r_lambda,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuning&nbsp;=&nbsp;tuning,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resampling&nbsp;=&nbsp;resampling,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;l1)<br />self_tuning_mach&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(self_tuning_model,&nbsp;</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">)<br /></span><span class="hl-function">fit!</span><span class="hl-plain">(self_tuning_mach,&nbsp;force&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">)<br /><br />best_model&nbsp;=&nbsp;</span><span class="hl-function">fitted_params</span><span class="hl-plain">(self_tuning_mach).best_model<br /><br /></span><span class="hl-function">plot_learning_curve</span><span class="hl-plain">(best_model,&nbsp;</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">)<br /></span></div></div><br /><p><img src='/assets/images/evaluate/newplot4.png' alt='image'>
看着有点不对啊:yum:</p></article>
			<nav class="docs-footer"></nav>
			<div class='giscus'></div>
		</div>
		<div class="modal" id="documenter-settings">
			<div class="modal-background"></div>
			<div class="modal-card">
				<header class="modal-card-head">
					<p class="modal-card-title">设置</p>
					<button class="delete"></button>
				</header>
				<section class="modal-card-body">
					<p><label class="label">选择主题</label>
						<div class="select">
							<select id="documenter-themepicker">
								<option value="light">light</option><option value="dark">dark</option>
							</select>
						</div>
					</p>
				</section>
				<footer class="modal-card-foot"></footer>
			</div>
		</div>
	</div>
</body>
</html>
