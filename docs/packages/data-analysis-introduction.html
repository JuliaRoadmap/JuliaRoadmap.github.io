<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Roadmap</title>
	<meta name="tURL" id="tURL" content="../../"/>
	<meta name="description" content="包的使用/数据分析简介 - Roadmap">
	<script src="../../js/menu.js"></script>
	<script src='https://giscus.app/client.js' data-repo='JuliaRoadmap/zh' data-repo-id='R_kgDOHQYI2Q' data-category='General' data-category-id='DIC_kwDOHQYI2c4CO2c9' data-mapping='pathname' data-reactions-enabled='1' data-emit-metadata='0' data-input-position='top' data-theme='preferred_color_scheme' data-lang='zh-CN' crossorigin='anonymous' async></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../js/main.js"></script>
	<link id="theme-href" rel="stylesheet" type="text/css" href="../../css/light.css">
	<link rel="stylesheet" type="text/css" href="../../css/general.css">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
</head>
<body>
	<div id="documenter">
		<nav class="docs-sidebar">
			<a class="docs-logo"><img src="../../assets/images/logo.png" alt="alt" height="96" width="144"></a>
			<div class="docs-package-name">
			<span class="docs-autofit">Roadmap</span>
			</div>
			<ul class="docs-menu"></ul>
		</nav>
		<div class="docs-main">
			<header class="docs-navbar">
				<nav class="breadcrumb">
					<ul class="is-hidden-mobile"><li class="is-active">包的使用 / 数据分析简介</li></ul>
					<ul class="is-hidden-tablet"><li class="is-active">包的使用 / 数据分析简介</li></ul>
				</nav>
				<div class="docs-right">
					<a class="docs-edit-link" href="https://github.com/JuliaRoadmap/zh/tree/master/docs/packages/data-analysis-introduction.md" target="_blank">
						<span class="docs-label is-hidden-touch">编辑此页面</span>
					</a>
					<a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="设置"></a>
					<a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a>
				</div>
			</header>
			<article class="content"><h1 id='header-数据分析简介'>数据分析简介<a class='docs-heading-anchor-permalink'></a></h1><p>从一个简单的流程讲起：<br /><br />倘若我们已经准备好训练集和测试集, <strong>train_features</strong>, <strong>train_lables</strong>, <strong>test_feature</strong>, <strong>test_labels</strong><br />ps: 看看就好，我没给出数据集
在MLJ中，我们的习惯是构造一个机器<code>machine</code>来包装模型<code>model</code>和数据</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-macro">@load</span><span class="hl-plain">&nbsp;</span><span class="hl-type">DecisionTreeClassifier</span><span class="hl-plain"><br />model&nbsp;=&nbsp;</span><span class="hl-type">DecisionTreeClassifier</span><span class="hl-plain">()<br />mach&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(model,&nbsp;train_features,&nbsp;train_labels)<br /></span></div></div><br /><p>这是<code>model</code>的参数</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-type">DecisionTreeClassifier</span><span class="hl-plain">(<br />&nbsp;&nbsp;&nbsp;&nbsp;max_depth&nbsp;=&nbsp;-</span><span class="hl-number">1</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;min_samples_leaf&nbsp;=&nbsp;</span><span class="hl-number">1</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;min_samples_split&nbsp;=&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;min_purity_increase&nbsp;=&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;n_subfeatures&nbsp;=&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;post_prune&nbsp;=&nbsp;</span><span class="hl-special">false</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;merge_purity_threshold&nbsp;=&nbsp;</span><span class="hl-number">1</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;pdf_smoothing&nbsp;=&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,<br />&nbsp;&nbsp;&nbsp;&nbsp;display_depth&nbsp;=&nbsp;</span><span class="hl-number">5</span><span class="hl-plain">)&nbsp;@</span><span class="hl-number">706</span><span class="hl-plain"><br /></span></div></div><br /><p>对数据进行拟合后，要对机器进行评估</p><div class='language language-'><div class='codeblock-header'></div><div class='codeblock-body'>fit!(mach)<br /># resampling: 重采样策略<br /># measure: 评估指标<br /># weights: 权重<br /># shuffle: 是否打乱<br />evaluate!(mach, resampling = CV(nfolds = 6, shuffle = true, rng = 1234),<br />          measure = [area_under_curve, cross_entropy])<br /># also <br /># evaluate(model, train_features, train_labels,<br />            resampling = CV(nfolds = 6, shuffle = true, rng = 1234),<br />			measure = [area_under_curve, cross_entropy])<br /><br /></div></div><br /><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-repl-code">julia&gt;&nbsp;</span><span class="hl-function">evaluate!</span><span class="hl-plain">(mach,&nbsp;resampling&nbsp;=&nbsp;</span><span class="hl-type">CV</span><span class="hl-plain">(nfolds&nbsp;=&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">,&nbsp;shuffle&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,&nbsp;rng&nbsp;=&nbsp;</span><span class="hl-number">1234</span><span class="hl-plain">),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;[area_under_curve,&nbsp;cross_entropy])<br /></span><span class="hl-type">Evaluating&nbsp;over&nbsp;6&nbsp;folds:&nbsp;100</span><span class="hl-plain">%[=========================]&nbsp;</span><span class="hl-type">Time:&nbsp;0:00:00</span><span class="hl-plain"><br />┌──────────────────┬───────────────┬──────────────────────────────────────────┐<br />│&nbsp;_.measure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;_.measurement&nbsp;│&nbsp;_.per_fold&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│<br />├──────────────────┼───────────────┼──────────────────────────────────────────┤<br />│&nbsp;area_under_curve&nbsp;│&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">792</span><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;[</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">73</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">81</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">788</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">806</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">785</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">836</span><span class="hl-plain">]&nbsp;│<br />│&nbsp;cross_entropy&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">.</span><span class="hl-number">89</span><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;[</span><span class="hl-number">8</span><span class="hl-plain">.</span><span class="hl-number">54</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">7</span><span class="hl-plain">.</span><span class="hl-number">11</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">7</span><span class="hl-plain">.</span><span class="hl-number">11</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">4</span><span class="hl-plain">.</span><span class="hl-number">74</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">7</span><span class="hl-plain">.</span><span class="hl-number">11</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">.</span><span class="hl-number">73</span><span class="hl-plain">]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│<br />└──────────────────┴───────────────┴──────────────────────────────────────────┘<br />_.per_observation&nbsp;=&nbsp;[</span><span class="hl-special">missing</span><span class="hl-plain">,&nbsp;[[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">36</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">36</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">]]]<br />le&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,&nbsp;rng<br /></span></div></div><br /><p>如果对该机器的拟合效果不满意</p><p>可以要确定调整的参数范围，这里拿<code>model</code>的<code>n_subfeatures</code>属性为例</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">r&nbsp;=&nbsp;</span><span class="hl-function">range</span><span class="hl-plain">(model,&nbsp;:n_subfeatures,&nbsp;lower&nbsp;=&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">&nbsp;,&nbsp;upper&nbsp;=&nbsp;</span><span class="hl-number">3</span><span class="hl-plain">&nbsp;,&nbsp;scale&nbsp;=&nbsp;:linear)<br /></span></div></div><br /><p>再是要确定评估模型好坏的指标，这里选<code>cross_entropy</code></p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">cv&nbsp;=&nbsp;</span><span class="hl-type">CV</span><span class="hl-plain">(nfolds&nbsp;=&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">,&nbsp;shuffle&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,&nbsp;rng&nbsp;=&nbsp;</span><span class="hl-number">1234</span><span class="hl-plain">)<br />self_tuning_model&nbsp;=&nbsp;</span><span class="hl-type">TunedModel</span><span class="hl-plain">(model&nbsp;=&nbsp;model,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range&nbsp;=&nbsp;r,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;repeats&nbsp;=&nbsp;</span><span class="hl-number">3</span><span class="hl-plain">,&nbsp;&nbsp;</span><span class="hl-comment">#&nbsp;repeats:&nbsp;重采样次数</span><br /><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tuning&nbsp;=&nbsp;</span><span class="hl-type">RandomSearch</span><span class="hl-plain">(),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resampling&nbsp;=&nbsp;cv,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;cross_entropy)<br />self_tuning_mach&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(self_tuning_model,&nbsp;train_features,&nbsp;train_labels)<br /></span></div></div><br /><p>拟合后，取最优模型</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-function">fit!</span><span class="hl-plain">(self_tuning_mach)<br />best_model&nbsp;=&nbsp;</span><span class="hl-function">fitted_params</span><span class="hl-plain">(self_tuning_mach).best_model<br />best_mach&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(best_model,&nbsp;train_features,&nbsp;train_labels)<br /></span></div></div><br /><p>查看评估结果</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-repl-code">julia&gt;&nbsp;</span><span class="hl-function">evaluate!</span><span class="hl-plain">(best_mach,&nbsp;resampling&nbsp;=&nbsp;cv,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;[area_under_curve,&nbsp;cross_entropy])<br /></span><span class="hl-type">Evaluating&nbsp;over&nbsp;6&nbsp;folds:&nbsp;100</span><span class="hl-plain">%[=========================]&nbsp;</span><span class="hl-type">Time:&nbsp;0:00:00</span><span class="hl-plain"><br />┌──────────────────┬───────────────┬────────────────────────────────────────────┐<br />│&nbsp;_.measure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;_.measurement&nbsp;│&nbsp;_.per_fold&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│<br />├──────────────────┼───────────────┼────────────────────────────────────────────┤<br />│&nbsp;area_under_curve&nbsp;│&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">804</span><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;[</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">714</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">812</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">819</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">861</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">771</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">845</span><span class="hl-plain">]&nbsp;│<br />│&nbsp;cross_entropy&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">.</span><span class="hl-number">97</span><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;[</span><span class="hl-number">9</span><span class="hl-plain">.</span><span class="hl-number">01</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">.</span><span class="hl-number">64</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">7</span><span class="hl-plain">.</span><span class="hl-number">59</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">5</span><span class="hl-plain">.</span><span class="hl-number">69</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">.</span><span class="hl-number">64</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">.</span><span class="hl-number">25</span><span class="hl-plain">]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│<br />└──────────────────┴───────────────┴────────────────────────────────────────────┘<br />_.per_observation&nbsp;=&nbsp;[</span><span class="hl-special">missing</span><span class="hl-plain">,&nbsp;[[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">36</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">]]]<br /></span></div></div><br /><p>如果要调整多个参数怎么办?</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">r1&nbsp;=&nbsp;</span><span class="hl-function">range</span><span class="hl-plain">(model,&nbsp;:hyper1,&nbsp;...)<br />r2&nbsp;=&nbsp;</span><span class="hl-function">range</span><span class="hl-plain">(model,&nbsp;:hyper2,&nbsp;...)<br />self_tuning_model&nbsp;=&nbsp;</span><span class="hl-type">TunedModel</span><span class="hl-plain">(model&nbsp;=&nbsp;model,&nbsp;range&nbsp;=&nbsp;[r1,&nbsp;r2],&nbsp;...)<br /></span></div></div><br /><p>TODO learning_curve
也可以用<strong>学习曲线 learning_curve</strong>先看看参数范围对评估结果的影响
同样要确定参数范围, 重采样策略和评估标准</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">curve&nbsp;=&nbsp;</span><span class="hl-function">learning_curve</span><span class="hl-plain">(mach,<br />	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;range&nbsp;=&nbsp;r_n,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resampling&nbsp;=&nbsp;</span><span class="hl-type">Holdout</span><span class="hl-plain">(fraction_train&nbsp;=&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">8</span><span class="hl-plain">,&nbsp;shuffle&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,&nbsp;rng&nbsp;=&nbsp;</span><span class="hl-number">1234</span><span class="hl-plain">),<br />					&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;cross_entropy)<br />						<br /><br /></span><span class="hl-function">plot</span><span class="hl-plain">(curves.parameter_values,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;curves.measurements,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xlab&nbsp;=&nbsp;curves.parameter_name,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ylab&nbsp;=&nbsp;</span><span class="hl-string">"Holdout&nbsp;estimate&nbsp;of&nbsp;cross_entropy&nbsp;error"</span><span class="hl-plain">)<br /></span></div></div><br /><p>![pic](/home/steiner/图片/2020-07-11 20-57-56 的屏幕截图.png)</p><p>最后，经过各种调整后，取得最优模型，r投入应用</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">best_model&nbsp;=&nbsp;</span><span class="hl-function">fitted_params</span><span class="hl-plain">(self_tuning_mach).best_model<br />best_machine&nbsp;=&nbsp;</span><span class="hl-function">machine</span><span class="hl-plain">(best_model,&nbsp;train_features,&nbsp;train_labels)<br />predict_labels&nbsp;=&nbsp;</span><span class="hl-function">predict</span><span class="hl-plain">(best_machine,&nbsp;test_features)<br /></span></div></div><br /><p>用测试样本评估</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-repl-code">julia&gt;&nbsp;</span><span class="hl-function">evaluate</span><span class="hl-plain">(best_model,&nbsp;test_features,&nbsp;test_labels,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resampling&nbsp;=&nbsp;cv,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;[area_under_curve,&nbsp;cross_entropy])<br /></span><span class="hl-type">Evaluating&nbsp;over&nbsp;6&nbsp;folds:&nbsp;100</span><span class="hl-plain">%[=========================]&nbsp;</span><span class="hl-type">Time:&nbsp;0:00:00</span><span class="hl-plain"><br />┌──────────────────┬───────────────┬──────────────────────────────────────────┐<br />│&nbsp;_.measure&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;_.measurement&nbsp;│&nbsp;_.per_fold&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│<br />├──────────────────┼───────────────┼──────────────────────────────────────────┤<br />│&nbsp;area_under_curve&nbsp;│&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">849</span><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;[</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">782</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">9</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">923</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">872</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">786</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">0</span><span class="hl-plain">.</span><span class="hl-number">833</span><span class="hl-plain">]&nbsp;│<br />│&nbsp;cross_entropy&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">.</span><span class="hl-number">64</span><span class="hl-plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;[</span><span class="hl-number">7</span><span class="hl-plain">.</span><span class="hl-number">59</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">3</span><span class="hl-plain">.</span><span class="hl-number">79</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">5</span><span class="hl-plain">.</span><span class="hl-number">69</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">9</span><span class="hl-plain">.</span><span class="hl-number">49</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">7</span><span class="hl-plain">.</span><span class="hl-number">59</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">5</span><span class="hl-plain">.</span><span class="hl-number">69</span><span class="hl-plain">]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│<br />└──────────────────┴───────────────┴──────────────────────────────────────────┘<br />_.per_observation&nbsp;=&nbsp;[</span><span class="hl-special">missing</span><span class="hl-plain">,&nbsp;[[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">36</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">36</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">36</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">36</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">],&nbsp;[</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">.</span><span class="hl-number">22e</span><span class="hl-plain">-</span><span class="hl-number">16</span><span class="hl-plain">,&nbsp;...,&nbsp;</span><span class="hl-number">36</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">]]]<br /></span></div></div><br /><h3 id='header-总结一下'>总结一下<a class='docs-heading-anchor-permalink'></a></h3><p>流程: machine 构造 -&gt; 评估 -&gt; 调整--&gt; 投入应用
^            |
|____________|</p><h3 id='header-几点疑惑'>几点疑惑<a class='docs-heading-anchor-permalink'></a></h3><ol><li>
<p>TunedModel
1.1 模型调整中 GridSearch调整策略的参数
<code>Grid(goal=nothing, resolution=10, rng=Random.GLOBAL_RNG, shuffle=true)</code>
<code>rng</code>, <code>shuffle</code>我都清楚，不过<code>goal</code>和<code>resolution</code>我就不知道了
1.2 TunedModel 中参数<code>n</code>的确定
<code>n=default_n(tuning, range)</code>
也可以自己设定， 现在我不知道<code>tuning</code>策略与<code>range</code>有什么关系，尤其是<code>GridSearch</code>
1.3 range中的<code>scale</code>
文档是这么写的
&gt;   If scale is unspecified, it is set to :linear, :log, :logminus, or :linear,
according to whether the interval (lower, upper) is bounded, right-unbounded,
left-unbounded, or doubly unbounded, respectively. Note upper=Inf and lower=-Inf
are allowed.
我的问题是，这玩样是不是从<code>lower</code>到<code>upper</code>，然后画一条<code>scale</code>的曲线，他的个数与<code>tuning</code>策略之间会相互影响吗？</p>
</li>
</ol><ol><li>
<p>learning_curve
2.1 绘制多条曲线
在文档里我只看到<code>EnsembleModel</code>的例子
```julia
X, y = @load_boston
atom = @load RidgeRegressor pkg=MultivariateStats
ensemble = EnsembleModel(atom = atom, n = 1000)
mach = machine(ensemble, X, y)</p>
<pre><code>atom.lambda = 200
r_n = range(ensemble, :n, lower = 1, upper = 50)

 curves = learning_curve(mach,
                         range = r_n,
                         rng_name = :rng,
                         rngs = 4,
                         resampling = Holdout(fraction_train = 0.8))

 plot(curves.parameter_values,
 	 curves.measurements,
      xlab = curves.parameter_name,
      ylab = &quot;Holdout estimate of RMS error&quot;)
 ```
</code></pre>
</li>
</ol><p><img src='https://alan-turing-institute.github.io/MLJ.jl/stable/img/learning_curve_n.png' alt='pic'></p><h3 id='header-最后'>最后<a class='docs-heading-anchor-permalink'></a></h3><p>谁能告诉我markdown怎么贴那种精致的表格，我的<code>evaluate</code>结果全被打乱了</p></article>
			<nav class="docs-footer"></nav>
			<div class='giscus'></div>
		</div>
		<div class="modal" id="documenter-settings">
			<div class="modal-background"></div>
			<div class="modal-card">
				<header class="modal-card-head">
					<p class="modal-card-title">设置</p>
					<button class="delete"></button>
				</header>
				<section class="modal-card-body">
					<p><label class="label">选择主题</label>
						<div class="select">
							<select id="documenter-themepicker">
								<option value="light">light</option><option value="dark">dark</option>
							</select>
						</div>
					</p>
				</section>
				<footer class="modal-card-foot"></footer>
			</div>
		</div>
	</div>
</body>
</html>
