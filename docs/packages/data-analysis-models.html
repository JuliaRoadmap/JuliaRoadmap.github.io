<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Roadmap</title>
	<meta name="tURL" id="tURL" content="../../"/>
	<meta name="description" content="包的使用/模型搜索 - Roadmap">
	<script src="../../js/menu.js"></script>
	<script src='https://giscus.app/client.js' data-repo='JuliaRoadmap/zh' data-repo-id='R_kgDOHQYI2Q' data-category='General' data-category-id='DIC_kwDOHQYI2c4CO2c9' data-mapping='pathname' data-reactions-enabled='1' data-emit-metadata='0' data-input-position='top' data-theme='preferred_color_scheme' data-lang='zh-CN' crossorigin='anonymous' async></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../js/main.js"></script>
	<link id="theme-href" rel="stylesheet" type="text/css" href="../../css/light.css">
	<link rel="stylesheet" type="text/css" href="../../css/general.css">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css"/>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
</head>
<body>
	<div id="documenter">
		<nav class="docs-sidebar">
			<a class="docs-logo"><img src="../../assets/images/logo.png" alt="alt" height="96" width="144"></a>
			<div class="docs-package-name">
			<span class="docs-autofit">Roadmap</span>
			</div>
			<ul class="docs-menu"></ul>
		</nav>
		<div class="docs-main">
			<header class="docs-navbar">
				<nav class="breadcrumb">
					<ul class="is-hidden-mobile"><li class="is-active">包的使用 / 模型搜索</li></ul>
					<ul class="is-hidden-tablet"><li class="is-active">包的使用 / 模型搜索</li></ul>
				</nav>
				<div class="docs-right">
					<a class="docs-edit-link" href="https://github.com/JuliaRoadmap/zh/tree/master/docs/packages/data-analysis-models.md" target="_blank">
						<span class="docs-label is-hidden-touch">编辑此页面</span>
					</a>
					<a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="设置"></a>
					<a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a>
				</div>
			</header>
			<article class="content"><h1 id='header-模型搜索'>模型搜索<a class='docs-heading-anchor-permalink'></a></h1><h3 id='header-1.1 用数据搜索'>1.1 用数据搜索<a class='docs-heading-anchor-permalink'></a></h3><p>以<strong>波士顿房价数据集</strong>为例，寻找适合的模型</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-type">X,&nbsp;y&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-macro">@load_boston</span><span class="hl-plain"><br /></span><span class="hl-function">models</span><span class="hl-plain">(</span><span class="hl-function">matching</span><span class="hl-plain">(</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">))<br /></span></div></div><br /><p>不过在此之前我们先看看数据集的科学类型</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-function">schema</span><span class="hl-plain">(</span><span class="hl-type">X</span><span class="hl-plain">)<br /></span></div></div><br /><table style='float:center'><thead><tr><td>_.name</td><td>_.types</td><td>_.scitypes</td></tr></thead><tbody><tr><td>Crim</td><td>Float64</td><td>Continuous</td></tr><tr><td>Zn</td><td>Float64</td><td>Continuous</td></tr><tr><td>Indus</td><td>Float64</td><td>Continuous</td></tr><tr><td>NOx</td><td>Float64</td><td>Continuous</td></tr><tr><td>Rm</td><td>Float64</td><td>Continuous</td></tr><tr><td>Age</td><td>Float64</td><td>Continuous</td></tr><tr><td>Dis</td><td>Float64</td><td>Continuous</td></tr><tr><td>Rad</td><td>Float64</td><td>Continuous</td></tr><tr><td>Tax</td><td>Float64</td><td>Continuous</td></tr><tr><td>PTRatio</td><td>Float64</td><td>Continuous</td></tr><tr><td>Black</td><td>Float64</td><td>Continuous</td></tr><tr><td>LStat</td><td>Float64</td><td>Continuous</td></tr></tbody></table><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-function">scitype</span><span class="hl-plain">(y)<br /></span></div></div><br /><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-type">AbstractArray{Continuous,&nbsp;1}</span><span class="hl-plain"><br /></span></div></div><br /><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-repl-code">julia&gt;&nbsp;</span><span class="hl-function">models</span><span class="hl-plain">(</span><span class="hl-function">matching</span><span class="hl-plain">(</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">))<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">ARDRegressor,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">AdaBoostRegressor,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">BaggingRegressor,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">BayesianRidgeRegressor,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">ConstantRegressor,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">MLJModels,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;...&nbsp;<br /></span></div></div><br /><h3 id='header-1.2 用函数搜索'>1.2 用函数搜索<a class='docs-heading-anchor-permalink'></a></h3><p>我们先用搜索到的模型来举例</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-function">info</span><span class="hl-plain">(</span><span class="hl-string">"ARDRegressor"</span><span class="hl-plain">,&nbsp;pkg=</span><span class="hl-string">"ScikitLearn"</span><span class="hl-plain">)<br /></span></div></div><br /><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-repl-code">julia&gt;&nbsp;</span><span class="hl-function">info</span><span class="hl-plain">(</span><span class="hl-string">"ARDRegressor"</span><span class="hl-plain">,&nbsp;pkg=</span><span class="hl-string">"ScikitLearn"</span><span class="hl-plain">)<br /></span><span class="hl-type">Bayesian&nbsp;ARD&nbsp;regression</span><span class="hl-plain">.<br />→&nbsp;based&nbsp;on&nbsp;[</span><span class="hl-type">ScikitLearn</span><span class="hl-plain">](https://github.com/cstjean/</span><span class="hl-type">ScikitLearn</span><span class="hl-plain">.jl).<br />→&nbsp;</span><span class="hl-keyword">do</span><span class="hl-plain">&nbsp;</span><span class="hl-string">`@load&nbsp;ARDRegressor&nbsp;pkg="ScikitLearn"`</span><span class="hl-plain">&nbsp;to&nbsp;use&nbsp;the&nbsp;model.<br />→&nbsp;</span><span class="hl-keyword">do</span><span class="hl-plain">&nbsp;</span><span class="hl-string">`?ARDRegressor`</span><span class="hl-plain">&nbsp;</span><span class="hl-keyword">for</span><span class="hl-plain">&nbsp;documentation.<br />(name&nbsp;=&nbsp;</span><span class="hl-string">"ARDRegressor"</span><span class="hl-plain">,<br />&nbsp;package_name&nbsp;=&nbsp;</span><span class="hl-string">"ScikitLearn"</span><span class="hl-plain">,<br />&nbsp;is_supervised&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,<br />&nbsp;docstring&nbsp;=&nbsp;</span><span class="hl-string">"Bayesian&nbsp;ARD&nbsp;regression.</span><span class="hl-escape">\n</span><span class="hl-string">→&nbsp;based&nbsp;on&nbsp;[ScikitLearn](https://github.com/cstjean/ScikitLearn.jl).</span><span class="hl-escape">\n</span><span class="hl-string">→&nbsp;do&nbsp;`@load&nbsp;ARDRegressor&nbsp;pkg=</span><span class="hl-escape">\"</span><span class="hl-string">ScikitLearn</span><span class="hl-escape">\"</span><span class="hl-string">`&nbsp;to&nbsp;use&nbsp;the&nbsp;model.</span><span class="hl-escape">\n</span><span class="hl-string">→&nbsp;do&nbsp;`?ARDRegressor`&nbsp;for&nbsp;documentation."</span><span class="hl-plain">,<br />&nbsp;hyperparameter_ranges&nbsp;=&nbsp;(</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">,&nbsp;</span><span class="hl-special">nothing</span><span class="hl-plain">),<br />&nbsp;hyperparameter_types&nbsp;=&nbsp;(</span><span class="hl-string">"Int64"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Float64"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Float64"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Float64"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Float64"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Float64"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Bool"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Float64"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Bool"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Bool"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Bool"</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">"Bool"</span><span class="hl-plain">),<br />&nbsp;hyperparameters&nbsp;=&nbsp;(:n_iter,&nbsp;:tol,&nbsp;:alpha_1,&nbsp;:alpha_2,&nbsp;:lambda_1,&nbsp;:lambda_2,&nbsp;:compute_score,&nbsp;:threshold_lambda,&nbsp;:fit_intercept,&nbsp;:normalize,&nbsp;:copy_X,&nbsp;:verbose),<br />&nbsp;implemented_methods&nbsp;=&nbsp;[:clean!,&nbsp;:fit,&nbsp;:fitted_params,&nbsp;:predict],<br />&nbsp;is_pure_julia&nbsp;=&nbsp;</span><span class="hl-special">false</span><span class="hl-plain">,<br />&nbsp;is_wrapper&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,<br />&nbsp;load_path&nbsp;=&nbsp;</span><span class="hl-string">"MLJScikitLearnInterface.ARDRegressor"</span><span class="hl-plain">,<br />&nbsp;package_license&nbsp;=&nbsp;</span><span class="hl-string">"BSD"</span><span class="hl-plain">,<br />&nbsp;package_url&nbsp;=&nbsp;</span><span class="hl-string">"https://github.com/cstjean/ScikitLearn.jl"</span><span class="hl-plain">,<br />&nbsp;package_uuid&nbsp;=&nbsp;</span><span class="hl-string">"3646fa90-6ef7-5e7e-9f22-8aca16db6324"</span><span class="hl-plain">,<br />&nbsp;prediction_type&nbsp;=&nbsp;:deterministic,<br />&nbsp;supports_online&nbsp;=&nbsp;</span><span class="hl-special">false</span><span class="hl-plain">,<br />&nbsp;supports_weights&nbsp;=&nbsp;</span><span class="hl-special">false</span><span class="hl-plain">,<br />&nbsp;input_scitype&nbsp;=&nbsp;</span><span class="hl-type">Table{_s23}&nbsp;where&nbsp;_s23</span><span class="hl-plain">&lt;:(</span><span class="hl-type">AbstractArray{_s25,1}&nbsp;where&nbsp;_s25</span><span class="hl-plain">&lt;:</span><span class="hl-type">Continuous</span><span class="hl-plain">),<br />&nbsp;target_scitype&nbsp;=&nbsp;</span><span class="hl-type">AbstractArray{Continuous,1},</span><span class="hl-plain"><br />&nbsp;output_scitype&nbsp;=&nbsp;</span><span class="hl-type">Unknown,</span><span class="hl-plain">)<br /></span></div></div><br /><p>这里我们用函数指定模型的输入数据的类型与输出数据的类型来寻找模型</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-function">fn</span><span class="hl-plain">(x)&nbsp;=&nbsp;x.input_scitype&nbsp;&lt;:&nbsp;</span><span class="hl-type">Table{T1}&nbsp;where&nbsp;T1&nbsp;</span><span class="hl-plain">&lt;:&nbsp;(</span><span class="hl-type">AbstractArray{T2,1}&nbsp;where&nbsp;T2&nbsp;</span><span class="hl-plain">&lt;:&nbsp;</span><span class="hl-type">Continuous</span><span class="hl-plain">)<br /></span><span class="hl-function">models</span><span class="hl-plain">(fn)<br /></span></div></div><br /><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">ARDRegressor,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">AdaBoostClassifier,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">AdaBoostRegressor,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">AffinityPropagation,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">AgglomerativeClustering,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br />&nbsp;(name&nbsp;=&nbsp;</span><span class="hl-type">BaggingClassifier,&nbsp;package_name&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">ScikitLearn,&nbsp;</span><span class="hl-plain">...&nbsp;)<br /><br /></span></div></div><br /><h2 id='header-2. 查看模型信息'>2. 查看模型信息<a class='docs-heading-anchor-permalink'></a></h2><p>紧接上面的查询到的内容<code>info("ARDRegressor", pkg="ScikitLearn")</code>
输入的<code>X</code>为</p><blockquote><p>input_scitype = Table{_s23} where _s23&lt;:(AbstractArray{_s25,1} where _s25&lt;:Continuous),</p></blockquote><p>得到的<code>y</code>的科学类型为</p><blockquote><p>target_scitype = AbstractArray{Continuous,1},</p></blockquote><h2 id='header-3. 加载模型'>3. 加载模型<a class='docs-heading-anchor-permalink'></a></h2><p>按照文档里的加载模型，随便试一下好了</p><blockquote><p>→ do <code>@load ARDRegressor pkg="ScikitLearn"</code> to use the model.
→ do <code>?ARDRegressor</code> for documentation.</p></blockquote><p>为什么导入的方式这么奇怪，不用原生的<code>import</code>呢？
这是因为<strong>MLJ</strong>是一个界面，他负责把一堆模型的用法统一成一个样子，但是他内置的模型比较少，需要从其他语言中调用模型，所以用<code>@load</code>从外面把模型引入，由于有许多机器学习包的模型名字是一样的，需要指定包的名称，在<code>@load</code>后面指定<code>pkg</code>。
如果不知道<code>pkg</code>的话，那么提供模型的包必须是唯一的</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-macro">@load</span><span class="hl-plain">&nbsp;</span><span class="hl-type">ARDRegressor&nbsp;pkg</span><span class="hl-plain">=</span><span class="hl-type">ScikitLearn</span><span class="hl-plain"><br />model&nbsp;=&nbsp;</span><span class="hl-type">ARDRegressor</span><span class="hl-plain">()<br />mach&nbsp;=&nbsp;</span><span class="hl-function">fit!</span><span class="hl-plain">(</span><span class="hl-function">machine</span><span class="hl-plain">(model,&nbsp;</span><span class="hl-type">X,&nbsp;y</span><span class="hl-plain">))<br /></span></div></div><br /><p>评估一下吧</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-function">evaluate!</span><span class="hl-plain">(mach,&nbsp;resampling&nbsp;=&nbsp;</span><span class="hl-type">CV</span><span class="hl-plain">(nfolds&nbsp;=&nbsp;</span><span class="hl-number">6</span><span class="hl-plain">,&nbsp;shuffle&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,&nbsp;rng&nbsp;=&nbsp;</span><span class="hl-type">StableRNG</span><span class="hl-plain">(</span><span class="hl-number">444</span><span class="hl-plain">)),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;measure&nbsp;=&nbsp;[rms,&nbsp;l1,&nbsp;l2])<br /></span></div></div><br /><table style='float:center'><thead><tr><td>_.measure</td><td>_.measurement</td><td>_.per_fold</td></tr></thead><tbody><tr><td>rms</td><td>5.01</td><td>[4.3, 5.85, 5.04, 5.19, 4.06, 5.41]</td></tr><tr><td>l1</td><td>3.5</td><td>[3.19, 3.97, 3.58, 3.66, 2.89, 3.7]</td></tr><tr><td>l2</td><td>25.1</td><td>[18.5, 34.2, 25.4, 26.9, 16.5, 29.2]</td></tr></tbody></table><p>_.per_observation = [missing, [[4.84, 1.0, ..., 7.41], [3.67, 0.981, ..., 7.29], [4.91, 5.23, ..., 3.21], [2.76, 2.83, ..., 3.67], [2.63, 0.412, ..., 0.468], [0.18, 0.043, ..., 1.02]], [[23.4, 1.0, ..., 54.9], [13.5, 0.962, ..., 53.2], [24.1, 27.4, ..., 10.3], [7.64, 8.03, ..., 13.5], [6.94, 0.17, ..., 0.219], [0.0325, 0.00185, ..., 1.05]]]</p><p>还不错，哟系</p><h2 id='header-3. 组合模型'>3. 组合模型<a class='docs-heading-anchor-permalink'></a></h2><h3 id='header-3.1 减小偏差 Boost'>3.1 减小偏差 Boost<a class='docs-heading-anchor-permalink'></a></h3><h3 id='header-3.2 减小方差 Bagging'>3.2 减小方差 Bagging<a class='docs-heading-anchor-permalink'></a></h3><h3 id='header-3.3 提升预测 Stacking'>3.3 提升预测 Stacking<a class='docs-heading-anchor-permalink'></a></h3><h3 id='header-3.4 简化操作 pipeline'>3.4 简化操作 pipeline<a class='docs-heading-anchor-permalink'></a></h3><p><code>pipeline</code>为我们提供了一条龙服务，就像<strong>流水线</strong>一样从数据准备到数据分析一步到位
先让我们看看需要经过多次处理的例子</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-keyword">using</span><span class="hl-plain">&nbsp;</span><span class="hl-type">MLJ</span><span class="hl-plain"><br /></span><span class="hl-keyword">using</span><span class="hl-plain">&nbsp;</span><span class="hl-type">MLJModels&nbsp;</span><span class="hl-comment">#&nbsp;for&nbsp;transform</span><br /><span class="hl-plain"><br /></span><span class="hl-type">X&nbsp;</span><span class="hl-plain">=&nbsp;(age&nbsp;=&nbsp;[</span><span class="hl-number">23</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">45</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">34</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">25</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">67</span><span class="hl-plain">],<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gender&nbsp;=&nbsp;</span><span class="hl-function">categorical</span><span class="hl-plain">([</span><span class="hl-string">'m'</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">'m'</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">'f'</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">'m'</span><span class="hl-plain">,&nbsp;</span><span class="hl-string">'f'</span><span class="hl-plain">]))<br />height&nbsp;=&nbsp;[</span><span class="hl-number">67</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">81</span><span class="hl-plain">.</span><span class="hl-number">5</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">55</span><span class="hl-plain">.</span><span class="hl-number">6</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">90</span><span class="hl-plain">.</span><span class="hl-number">0</span><span class="hl-plain">,&nbsp;</span><span class="hl-number">61</span><span class="hl-plain">.</span><span class="hl-number">1</span><span class="hl-plain">]<br /><br /></span><span class="hl-macro">@load</span><span class="hl-plain">&nbsp;</span><span class="hl-type">KNNRegressor&nbsp;pkg</span><span class="hl-plain">=</span><span class="hl-type">NearestNeighbors</span><span class="hl-plain"><br /></span><span class="hl-type">X1&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-function">coerce</span><span class="hl-plain">(</span><span class="hl-type">X,&nbsp;:age&nbsp;</span><span class="hl-plain">=&gt;&nbsp;</span><span class="hl-type">Continuous</span><span class="hl-plain">)<br /><br /></span><span class="hl-comment">#&nbsp;OneHotEncoder</span><br /><span class="hl-plain">model1&nbsp;=&nbsp;</span><span class="hl-type">OneHotEncoder</span><span class="hl-plain">()&nbsp;<br />mach1&nbsp;=&nbsp;</span><span class="hl-function">fit!</span><span class="hl-plain">(</span><span class="hl-function">machine</span><span class="hl-plain">(model1,&nbsp;</span><span class="hl-type">X1</span><span class="hl-plain">))<br /></span><span class="hl-type">X2&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-function">transform</span><span class="hl-plain">(mach1,&nbsp;</span><span class="hl-type">X1</span><span class="hl-plain">)<br /><br /></span><span class="hl-comment">#&nbsp;KNNRegressor&nbsp;拟合</span><br /><span class="hl-plain">model2&nbsp;=&nbsp;</span><span class="hl-type">KNNRegressor</span><span class="hl-plain">(</span><span class="hl-type">K&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-number">2</span><span class="hl-plain">)<br /><br /></span><span class="hl-comment">#&nbsp;最后评估</span><br /><span class="hl-function">evaluate</span><span class="hl-plain">(model2,&nbsp;</span><span class="hl-type">X,&nbsp;height,&nbsp;resampling&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">Holdout</span><span class="hl-plain">(),&nbsp;measure&nbsp;=&nbsp;l2)<br /></span></div></div><br /><p>再来看看用<code>pipeline</code>的例子</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">pipe&nbsp;=&nbsp;</span><span class="hl-macro">@pipeline</span><span class="hl-plain">(</span><span class="hl-type">X</span><span class="hl-plain">-&gt;&nbsp;</span><span class="hl-function">coerce</span><span class="hl-plain">(</span><span class="hl-type">X,&nbsp;:age&nbsp;</span><span class="hl-plain">=&gt;&nbsp;</span><span class="hl-type">Continuous</span><span class="hl-plain">),<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-type">OneHotEncoder,</span><span class="hl-plain"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="hl-type">KNNRegressor</span><span class="hl-plain">(</span><span class="hl-type">K</span><span class="hl-plain">=</span><span class="hl-number">2</span><span class="hl-plain">))p<br /></span><span class="hl-function">evaluate</span><span class="hl-plain">(pipe,&nbsp;</span><span class="hl-type">X,&nbsp;height,&nbsp;resampling&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-type">Holdout</span><span class="hl-plain">(),&nbsp;measure&nbsp;=&nbsp;l2)<br /></span></div></div><br /><p>我们可以往<code>@pipeline</code>宏里传递函数或<code>model</code>
如果要修改<code>pipeline</code>对象中的组成部分的参数，可以直接这样</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">pipe.knn_regressor.</span><span class="hl-type">K&nbsp;</span><span class="hl-plain">=&nbsp;</span><span class="hl-number">2</span><span class="hl-plain"><br /></span></div></div><br /><h3 id='header-3.5 一些疑问'>3.5 一些疑问<a class='docs-heading-anchor-permalink'></a></h3><p><code>pipeline</code>的一些关键字参数我有些不懂，尤其是<code>target</code></p><blockquote><p>target=... - any Unsupervised model or Function
inverse=... - any Function (unspecified if target is Unsupervised)
invert_last - set to true to delay target inversion to end of pipeline (default=true)
prediction_type - prediction type of the pipeline; possible values: :deterministic, :probabilistic, :interval (default=:deterministic if not inferable)
operation - operation applied to the supervised component model, when present; possible values: predict, predict_mean, predict_median, predict_mode (default=predict)
name - new composite model type name; can be any name not already in current global namespace (autogenerated by default)</p></blockquote><p>文档<a href='https://alan-turing-institute.github.io/MLJ.jl/stable/composing_models/#Linear-pipelines-1' target='_blank'>在这里</a>，有兴趣帮我看看吧:yum:</p><h2 id='header-补充'>补充<a class='docs-heading-anchor-permalink'></a></h2><p>像模型搜索一样，评估模型时的指标也可以搜索</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-plain">y&nbsp;=&nbsp;[</span><span class="hl-number">1</span><span class="hl-plain">,</span><span class="hl-number">2</span><span class="hl-plain">,</span><span class="hl-number">3</span><span class="hl-plain">]<br /></span><span class="hl-function">scitype</span><span class="hl-plain">(y)&nbsp;</span><span class="hl-comment">#&nbsp;AbstractArray{Count,1}</span><br /><span class="hl-function">measure</span><span class="hl-plain">(</span><span class="hl-function">matching</span><span class="hl-plain">(y))<br /></span></div></div><br /><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-repl-code">julia&gt;&nbsp;</span><span class="hl-function">measures</span><span class="hl-plain">(</span><span class="hl-function">matching</span><span class="hl-plain">(y))<br /></span><span class="hl-number">8</span><span class="hl-plain">-element&nbsp;</span><span class="hl-type">Array{NamedTuple{</span><span class="hl-plain">(:name,&nbsp;:target_scitype,&nbsp;:supports_weights,&nbsp;:prediction_type,&nbsp;:orientation,&nbsp;:reports_each_observation,&nbsp;:aggregation,&nbsp;:is_feature_dependent,&nbsp;:docstring,&nbsp;:distribution_type),</span><span class="hl-type">T</span><span class="hl-plain">}&nbsp;</span><span class="hl-keyword">where</span><span class="hl-plain">&nbsp;</span><span class="hl-type">T</span><span class="hl-plain">&lt;:</span><span class="hl-type">Tuple,1</span><span class="hl-plain">}:<br />&nbsp;(name&nbsp;=&nbsp;l1,&nbsp;...)<br />&nbsp;(name&nbsp;=&nbsp;l2,&nbsp;...)<br />&nbsp;(name&nbsp;=&nbsp;mae,&nbsp;...)<br />&nbsp;(name&nbsp;=&nbsp;mape,&nbsp;...)<br />&nbsp;(name&nbsp;=&nbsp;rms,&nbsp;...)<br />&nbsp;(name&nbsp;=&nbsp;rmsl,&nbsp;...)<br />&nbsp;(name&nbsp;=&nbsp;rmslp1,&nbsp;...)<br />&nbsp;(name&nbsp;=&nbsp;rmsp,&nbsp;...)<br /></span></div></div><br /><p>看看第一个</p><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-function">info</span><span class="hl-plain">(l1)&nbsp;</span><span class="hl-comment">#&nbsp;注意，&nbsp;在模型搜索中用的是info("model_name")，字符串，在指标搜索中用的是指标本身</span><br /></div></div><br /><div class='language language-julia'><div class='codeblock-header'></div><div class='codeblock-body'><span class="hl-repl-code">julia&gt;&nbsp;</span><span class="hl-function">info</span><span class="hl-plain">(l1)<br />absolute&nbsp;deviations;&nbsp;aliases:&nbsp;</span><span class="hl-string">`l1`</span><span class="hl-plain">.<br />(name&nbsp;=&nbsp;</span><span class="hl-string">"l1"</span><span class="hl-plain">,<br />&nbsp;target_scitype&nbsp;=&nbsp;</span><span class="hl-type">Union{AbstractArray{Continuous,1},&nbsp;AbstractArray{Count,1}},</span><span class="hl-plain"><br />&nbsp;supports_weights&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,<br />&nbsp;prediction_type&nbsp;=&nbsp;:deterministic,<br />&nbsp;orientation&nbsp;=&nbsp;:loss,<br />&nbsp;reports_each_observation&nbsp;=&nbsp;</span><span class="hl-special">true</span><span class="hl-plain">,<br />&nbsp;aggregation&nbsp;=&nbsp;</span><span class="hl-type">MLJBase</span><span class="hl-plain">.</span><span class="hl-type">Mean</span><span class="hl-plain">(),<br />&nbsp;is_feature_dependent&nbsp;=&nbsp;</span><span class="hl-special">false</span><span class="hl-plain">,<br />&nbsp;docstring&nbsp;=&nbsp;</span><span class="hl-string">"absolute&nbsp;deviations;&nbsp;aliases:&nbsp;`l1`."</span><span class="hl-plain">,<br />&nbsp;distribution_type&nbsp;=&nbsp;</span><span class="hl-special">missing</span><span class="hl-plain">,)<br /></span></div></div><br /></article>
			<nav class="docs-footer"></nav>
			<div class='giscus'></div>
		</div>
		<div class="modal" id="documenter-settings">
			<div class="modal-background"></div>
			<div class="modal-card">
				<header class="modal-card-head">
					<p class="modal-card-title">设置</p>
					<button class="delete"></button>
				</header>
				<section class="modal-card-body">
					<p><label class="label">选择主题</label>
						<div class="select">
							<select id="documenter-themepicker">
								<option value="light">light</option><option value="dark">dark</option>
							</select>
						</div>
					</p>
				</section>
				<footer class="modal-card-foot"></footer>
			</div>
		</div>
	</div>
</body>
</html>
